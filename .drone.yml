pipeline:
  test:
    image: node:8-alpine
    commands:
      - npm i
      - npm test
  publish:
    image: plugins/docker
    repo: swhurl/website
    force_tag: true
    tags:
      - latest
    secrets: [docker_username, docker_password]
    when:
      branch: master
